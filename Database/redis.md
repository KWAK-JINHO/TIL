# Redis 캐시로 사용하기

캐싱이란?
데이터의 원래 소스보다 빠르고 효율적으로 액세스할 수 있는 임시 데이터 저장소

어떨때 사용하나?
같은 데이터를 반복적 액세스
원본 보다 빠른 접근속도를 원할 때
변하지 않는 데이터

## 레디스란?

- 단순한 key-value로 구조
- 인메모리 데이터 저장소(RAM)으로, 평균 읽기 및 쓰기 속도가 1밀리세컨드 미만으로 초당 수백만건의 작업 가능, 지연율이 줄어들고 처리량이 늘어난다.

레디스를 사용할 때 어떻게 배치하는지에 따라서도 시스템에 영향을 미친다. 이를 캐싱 전략이라고도 하며, 데이터의 유형, 액세스 패턴을 고려해 캐싱전략을 수립해야한다.

### Look-Aside

레디스를 사용할때 가장 일반적인 구조

- 어플리케이션은 데이터를 조회할때 캐시를 먼저 조회
- 찾는 데이터가 없다면 DB를 조회하고 캐시에 저장한다.
- 찾는데이터가 없을때만 DB를 조회한다.(Lazy Loading)
- Redis가 다운되도라도 DB서버는 살아있기 때문에 장애가 터지지는 않지만 DB에 갑자기 많은 커넥션이 몰려 부하가 생길 수 있다. -> 캐시를 새로 투입하거나 DB에만 새로운 데이터를 저장한경우 처음에
  캐시미스가 엄청 맣생할 수 있다. 이럴 때는 DB에서 미리 캐시에 데이터를 밀어넣어주는 'Cache Warming'을 해주어야한다.

### Write-Around

DB에만 데이터를 저장하는 구조

- 일단 모든 데이터를 DB에 저장하고 캐시미스가 발생한 경우 캐시의 데이터를 끌어온다. 이경우는 캐시내의 데이터와 DB내의 데이터가 다를 수 있다.

### Write-Through

캐시에 먼저 저장하고 후에 DB에도 저장하는 구조

- 저장할 때마다 두단계 스탭 을 거친다. -> 상대적으로 느리다.
- 재사용되지 않는 데이터도 저장하여 리소스를 낭비한다. -> 데이터를 만료시간을 설정하는게 좋다. 하지만 이 값을 어떻게 관리하는지에 따라 장애 포인트가 될 수 있다.

# Redis 데이터 타입 활용하기

## KEY

- String: 제일 기본적인 타입으로 SET command로 저장한 데이터는 모두 String으로 저장된다.
- Bitmaps: bit 단위의 연산 가능
- Lists: 큐로 사용
- Hashes: Key 안에 또다른 Key와 Value의 쌍을 저장한다.
- Sets: 중복되지 않은 문자열의 집합
- Sorted Sets: 중복되지 않는 Sets 처럼 중복되지 않는 값이지만 모든 값은 Score라는 값으로 저장된다. 데이터가 저장될때부터 Score순으로 정렬되며 Score가 같다면 사전순으로 정렬
- HyperLogLogs: 많은 데이터를 다룰때 사용 중복되지 않은 값의 개수를 카운트할 때 사용
- Streams: Log를 저장할 때 사용
